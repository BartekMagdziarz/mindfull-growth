Story 3 – Emotion Selector Component

Goal

Create a reusable EmotionSelector component that allows users to select multiple emotions from a 2×2 quadrant grid. The component displays a quadrant selector as the first step, then shows emotions from the selected quadrant as selectable chips. Users can switch between quadrants while maintaining their selections, and selected emotions are displayed with the ability to remove them. This component will be used in Journal entries, Emotion logs, and (later) Exercises views.

⸻

Scope

1.	Component Structure & API
	•	Create a reusable EmotionSelector component:
	•	Location: src/components/EmotionSelector.vue
	•	Component API:
	•	Accepts v-model for selected emotion IDs: v-model="selectedEmotionIds" where selectedEmotionIds is string[]
	•	Emits update:modelValue when selection changes
	•	Optionally accepts initial selection via props (e.g., initialSelection?: string[])
	•	Component should be self-contained and handle its own internal state for quadrant navigation
	•	Follows Material Design principles for chips, buttons, and navigation

2.	Quadrant Selector UI
	•	First step: Display a quadrant selector with four large, visually distinct buttons/cards:
	•	High Energy / High Pleasantness:
	•	Visual indicator: Yellow/warm colors (e.g., amber, yellow, orange tones)
	•	Label: "High Energy / High Pleasantness" or similar clear label
	•	Icon: Optional positive, energetic icon (e.g., sun, star, upward arrow)
	•	High Energy / Low Pleasantness:
	•	Visual indicator: Red/orange colors (e.g., red, deep orange tones)
	•	Label: "High Energy / Low Pleasantness" or similar clear label
	•	Icon: Optional intense, alerting icon (e.g., lightning, warning, flame)
	•	Low Energy / High Pleasantness:
	•	Visual indicator: Green/calm colors (e.g., green, teal, soft blue tones)
	•	Label: "Low Energy / High Pleasantness" or similar clear label
	•	Icon: Optional calm, peaceful icon (e.g., leaf, water, moon)
	•	Low Energy / Low Pleasantness:
	•	Visual indicator: Blue/cool colors (e.g., blue, gray, muted tones)
	•	Label: "Low Energy / Low Pleasantness" or similar clear label
	•	Icon: Optional subdued, reflective icon (e.g., cloud, droplet, downward arrow)
	•	Each quadrant button should be:
	•	Large enough to be easily tappable/clickable
	•	Visually distinct with clear color coding
	•	Accessible (keyboard navigable, proper ARIA labels)
	•	Layout: Four quadrant buttons arranged in a 2×2 grid or similar layout that clearly represents the emotion grid concept

3.	Emotion Selection UI
	•	After selecting a quadrant:
	•	Display emotions from that quadrant as selectable chips/badges
	•	Emotions are retrieved from useEmotionStore using getEmotionsByQuadrant(selectedQuadrant)
	•	Layout: Grid or list layout of emotion chips
	•	Each emotion chip:
	•	Displays the emotion name (e.g., "Happy", "Anxious", "Serene")
	•	Material Design–style chip component (can use AppCard or create EmotionChip sub-component)
	•	Visual states:
	•	Unselected: Outlined style (e.g., outlined chip with border)
	•	Selected: Filled style (e.g., filled chip with background color)
	•	Clicking/tapping a chip toggles its selection state
	•	Users can select multiple emotions from the current quadrant
	•	Selected emotions are tracked in the component's internal state and synced with v-model

4.	Quadrant Navigation
	•	Users can switch between quadrants at any time:
	•	Quadrant buttons remain visible (e.g., as a horizontal row or sidebar) when viewing emotions
	•	Alternatively, provide a "Back" button to return to quadrant selection
	•	When switching quadrants:
	•	Selected emotions persist (users can select from multiple quadrants in one session)
	•	The emotion list updates to show emotions from the newly selected quadrant
	•	The currently active quadrant is visually indicated (e.g., highlighted button, active state)

5.	Selected Emotions Display
	•	Show all currently selected emotions as chips (regardless of which quadrant they came from):
	•	Display section: "Selected Emotions" or similar label
	•	Layout: Horizontal scrollable row or wrapping grid of selected emotion chips
	•	Each selected emotion chip:
	•	Shows the emotion name
	•	Has a remove/delete button (e.g., X icon, close button)
	•	Clicking the remove button deselects the emotion
	•	Visual distinction: Selected emotion chips use a different style (e.g., filled, different color) than unselected chips in the quadrant view
	•	If no emotions are selected, show a placeholder message (e.g., "No emotions selected")

6.	Component Integration
	•	The component uses useEmotionStore:
	•	On mount, ensure emotions are loaded (call emotionStore.loadEmotions() if needed)
	•	Use emotionStore.getEmotionsByQuadrant(quadrant) to get emotions for display
	•	Use emotionStore.getEmotionById(id) to resolve emotion names for selected emotion IDs
	•	v-model binding:
	•	Component accepts selectedEmotionIds (string[]) via v-model
	•	When user selects/deselects emotions, emit update:modelValue with the updated array
	•	When initialSelection prop is provided, initialize the component's internal state with those IDs
	•	Component should handle edge cases:
	•	Empty emotion list (if store hasn't loaded yet, show loading state)
	•	Invalid emotion IDs in initial selection (ignore invalid IDs, log warning if needed)
	•	No emotions in a quadrant (show "No emotions in this quadrant" message)

7.	Accessibility & UX
	•	Keyboard navigation:
	•	Quadrant buttons are keyboard accessible (Tab navigation, Enter/Space to activate)
	•	Emotion chips are keyboard accessible (Tab navigation, Enter/Space to toggle)
	•	Remove buttons on selected emotions are keyboard accessible
	•	ARIA labels:
	•	Quadrant buttons have descriptive labels (e.g., "Select High Energy High Pleasantness quadrant")
	•	Emotion chips have labels (e.g., "Select emotion: Happy")
	•	Selected emotions section has a label (e.g., "Selected emotions: 3 selected")
	•	Visual feedback:
	•	Hover states on interactive elements (quadrant buttons, chips, remove buttons)
	•	Focus states for keyboard navigation
	•	Active/pressed states for buttons
	•	Loading states: Show a loading indicator if emotions are being loaded from the store

8.	Styling & Material Design
	•	Use existing Material Design base components where possible:
	•	AppButton for quadrant buttons
	•	AppCard for emotion chips (or create EmotionChip component)
	•	Follow Material Design 3 principles:
	•	Rounded corners (consistent with app design system)
	•	Elevation/shadows where appropriate
	•	Color tokens from the app's theme (use CSS variables defined in main.css)
	•	Quadrant colors should be distinct but harmonious with the app's color scheme
	•	Responsive design:
	•	Component should work on mobile (touch-friendly chip sizes, adequate spacing)
	•	Component should work on desktop (hover states, keyboard navigation)

9.	Minimal Tests (Unit)
	•	Add unit tests (Vitest) for EmotionSelector component:
	•	Location: src/components/__tests__/EmotionSelector.spec.ts
	•	Test cases:
	•	Component renders:
	•	Renders quadrant selector with four quadrant buttons
	•	Each quadrant button displays correct label and visual indicator
	•	Quadrant selection:
	•	Clicking a quadrant button displays emotions from that quadrant
	•	Emotions are displayed as chips
	•	Emotion selection:
	•	Clicking an unselected emotion chip selects it
	•	Clicking a selected emotion chip deselects it
	•	Multiple emotions can be selected from the same quadrant
	•	Selected emotions display:
	•	Selected emotions appear in the "Selected Emotions" section
	•	Selected emotions can be removed via the remove button
	•	Cross-quadrant selection:
	•	Selecting emotions from one quadrant, then switching to another quadrant, preserves previous selections
	•	Selected emotions from multiple quadrants all appear in the selected emotions section
	•	v-model binding:
	•	Component emits update:modelValue when emotions are selected
	•	Component emits update:modelValue when emotions are deselected
	•	Component accepts initial selection via props and pre-selects those emotions
	•	Store integration:
	•	Component calls emotionStore.loadEmotions() on mount
	•	Component uses emotionStore.getEmotionsByQuadrant() to get emotions
	•	Edge cases:
	•	Component handles empty emotion list gracefully (shows loading or empty state)
	•	Component handles invalid emotion IDs in initial selection (ignores them)
	•	Use Vue Test Utils and @testing-library/vue for component testing
	•	Mock useEmotionStore in tests (don't hit real store implementation)

⸻

Acceptance Criteria

	•	EmotionSelector component exists at src/components/EmotionSelector.vue
	•	Component accepts v-model for selected emotion IDs (string[])
	•	Component displays quadrant selector with four visually distinct quadrants:
	•	High Energy / High Pleasantness (yellow/warm colors)
	•	High Energy / Low Pleasantness (red/orange colors)
	•	Low Energy / High Pleasantness (green/calm colors)
	•	Low Energy / Low Pleasantness (blue/cool colors)
	•	Selecting a quadrant displays emotions from that quadrant as selectable chips
	•	Users can select multiple emotions from any quadrant
	•	Selected emotions are displayed in a "Selected Emotions" section with remove functionality
	•	Users can switch between quadrants while maintaining their selections
	•	Selected emotions persist when switching quadrants (cross-quadrant selection works)
	•	Component integrates with useEmotionStore:
	•	Loads emotions on mount
	•	Uses getEmotionsByQuadrant() to display emotions
	•	Uses getEmotionById() to resolve emotion names
	•	v-model binding works correctly:
	•	Component emits update:modelValue when selection changes
	•	Component accepts initial selection via props
	•	Component is accessible:
	•	Keyboard navigable (Tab, Enter/Space)
	•	ARIA labels on interactive elements
	•	Focus and hover states visible
	•	Component follows Material Design principles and uses app's design system
	•	Component handles edge cases gracefully (empty states, loading states, invalid IDs)
	•	All unit tests pass:
	•	Component renders correctly
	•	Quadrant selection works
	•	Emotion selection works (single and multiple)
	•	Cross-quadrant selection works
	•	v-model binding works
	•	Store integration works
	•	Edge cases are handled
	•	No linting errors or TypeScript errors
	•	Component is ready to be used in Journal Editor and Emotion Log Editor (stories 7 and 11)

⸻

Out of Scope

	•	Tag input components (this is Story 4: Tag Input Components)
	•	Integration with Journal entries or Emotion logs (this comes in later stories: Story 7 for Journal, Story 11 for Emotion Logs)
	•	Emotion search or filtering beyond quadrant-based selection
	•	Emotion descriptions in the UI (descriptions are optional and may be used later, but not required for this story)
	•	Visual representation of the full 2×2 grid as a single view (component uses quadrant-based navigation)
	•	Emotion statistics or analytics
	•	Custom emotion creation (emotions are static seed data)
	•	E2E tests (they will make more sense once the component is integrated into views in later stories)
	•	Advanced animations or transitions (basic hover/focus states are sufficient)
	•	Emotion chip customization (colors, sizes) beyond Material Design defaults

⸻

Inconsistencies & Notes

	1.	Component Location:
	•	The component should be placed in src/components/EmotionSelector.vue to match the existing component structure (AppButton, AppCard, etc. are in src/components/)
	•	This is consistent with the project structure

	2.	Store Integration:
	•	Story 1 (Emotions Database & Domain Model) has already implemented useEmotionStore with:
	•	getAllEmotions() getter
	•	getEmotionsByQuadrant(quadrant) function
	•	getEmotionById(id) function
	•	loadEmotions() action
	•	The EmotionSelector component will depend on this store, which is already available
	•	No inconsistencies here – the component can use the existing store implementation

	3.	Quadrant Colors & Visual Design:
	•	The epic suggests specific color schemes for each quadrant (yellow/warm, red/orange, green/calm, blue/cool)
	•	These colors should align with the app's Material Design theme tokens (defined in main.css)
	•	If the suggested colors don't match the theme, they should be adjusted to use theme-compatible colors while maintaining visual distinction
	•	Recommendation: Use theme color tokens where possible, or define quadrant-specific color tokens that complement the existing theme

	4.	Database & Persistence:
	•	This story does not involve database changes or persistence
	•	Emotions are loaded from static seed data (emotions.json) via useEmotionStore
	•	Selected emotions are managed in component state and passed via v-model to parent components
	•	Persistence of selected emotions happens in parent components (Journal Editor, Emotion Log Editor) in later stories
	•	No database version changes needed for this story

	5.	Component Reusability:
	•	The component is designed to be reusable across multiple views:
	•	Journal Editor (Story 7)
	•	Emotion Log Editor (Story 11)
	•	Potentially Exercises view (future epic)
	•	The v-model API ensures the component can be easily integrated into any parent component
	•	No inconsistencies – the design supports reusability

	6.	Testing Strategy:
	•	Unit tests should mock useEmotionStore to avoid dependencies on real store state
	•	Tests should verify component behavior, not store behavior (store is tested in Story 1)
	•	Integration tests (testing component + store together) can be added in Story 12 (Comprehensive Testing)
	•	This aligns with the testing strategy outlined in the epic

	7.	Story Dependencies:
	•	This story depends on Story 1 (Emotions Database & Domain Model) being complete
	•	Story 1 is complete, so this dependency is satisfied
	•	This story can be developed in parallel with Story 4 (Tag Input Components) once Stories 1 and 2 are complete
	•	Story 2 (People & Context Tag Domain Models) is complete, so Story 4 can proceed
	•	No blocking dependencies for this story

