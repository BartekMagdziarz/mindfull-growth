Epic 1 – Journaling View & App Shell Foundation

1. Goal

Establish the core application shell and implement the first functional feature: the Journal – Freeform entry flow. By the end of this epic, the app should provide a Material Design–inspired layout, a working navigation structure, and a complete "create journal entry → persist locally → view in list → edit entry → delete entry" loop.

⸻

2. Scope

This epic covers:
	1.	App Shell & Navigation
	•	Implement a root layout with:
	•	Top app bar (application name / placeholder).
	•	Bottom navigation aligned with the planned main views:
	•	Today
	•	Journal
	•	Emotions
	•	Exercises
	•	Profile
	•	Configure Vue Router with routes for:
	•	/today
	•	/journal
	•	/emotions
	•	/exercises
	•	/profile
	•	Each route initially renders a simple placeholder view, except for Journal which is part of this epic.
	2.	Design System Base (Material + Tailwind)
	•	Adopt Material Design 3 as the primary design language.
	•	Implement a minimal, reusable design system using:
	•	TailwindCSS for layout, spacing, and typography.
	•	A small set of shared, Material-inspired components, for example:
	•	AppButton with variants (e.g. filled, outlined, text, tonal).
	•	AppCard for key actions and list items.
	•	AppTopAppBar and AppBottomNav.
	•	AppDialog for confirmations and modal interactions.
	•	Introduce theme tokens via CSS variables, wired into Tailwind configuration:
	•	--color-primary, --color-on-primary, --color-surface, --color-surface-variant, --color-outline, etc.
	•	Ensure buttons, cards, and navigation follow Material principles (rounded corners, elevation, hover/pressed states).
	3.	Journal Domain Model & Local Persistence
Data model (initial):

interface JournalEntry {
  id: string;          // UUID
  createdAt: string;   // ISO timestamp
  updatedAt: string;   // ISO timestamp
  title?: string;
  body: string;
  // Emotion tags and other metadata will be added in later epics.
}

	•	Define a repository interface for journal entries:

interface JournalRepository {
  getAll(): Promise<JournalEntry[]>;
  getById(id: string): Promise<JournalEntry | undefined>;
  create(
    data: Omit<JournalEntry, "id" | "createdAt" | "updatedAt">
  ): Promise<JournalEntry>;
  update(entry: JournalEntry): Promise<JournalEntry>;
  delete(id: string): Promise<void>;
}


	•	Implement a concrete repository using IndexedDB via Dexie.
	•	Implement a Pinia store useJournalStore that:
	•	Holds entries: JournalEntry[].
	•	Provides actions:
	•	loadEntries()
	•	createEntry(payload)
	•	updateEntry(entry)
	•	deleteEntry(id)
	•	Delegates persistence to the repository implementation.
	•	Ensure entries are loaded on app start or when the Journal view is mounted.

	4.	Journal View (Entry Point)
Route: /journal → JournalView
UI/behavior:
	•	Top app bar with title “Journal”.
	•	Central area with three large Material-style cards or buttons representing the main journal modes:
	•	Free form – active and fully implemented.
	•	Guided – visible, but placeholder (disabled or “Coming soon” behavior).
	•	Periodic – visible, but placeholder.
	•	Underneath these primary actions:
	•	If there are no entries:
	•	Display an empty state message (e.g. “Your journal entries will appear here.”).
	•	If entries exist:
	•	Display a vertical list of entries (most recent first).
	•	Each entry shown as a list item/card with:
	•	Title (or "Untitled entry" if empty).
	•	Creation date/time.
	•	A short preview: first 100 characters of the body text, with ellipsis ("...") if truncated.
	•	Clicking Free form:
	•	Navigates to the freeform editor route /journal/edit (create mode).
	•	Clicking an entry card:
	•	Navigates to /journal/:id/edit (edit mode) to edit the selected entry.
	•	Each entry card has a delete button (trash icon) in the top-right corner:
	•	Clicking delete shows a confirmation dialog.
	•	Confirming deletion removes the entry from the list.
	•	Clicking Guided / Periodic:
	•	For now, either:
	•	Show a non-interactive disabled state, or
	•	Show a non-blocking "Coming soon" hint.
	5.	Freeform Journal Editor
	Routes: /journal/edit (create mode) and /journal/:id/edit (edit mode) → JournalEditorView
	UI/behavior:
	•	Top app bar:
	•	Back navigation (to /journal).
	•	Title such as "New entry" or "Edit entry" (depending on mode).
	•	Content:
	•	Title field (optional).
	•	Body field – multiline text area filling the available vertical space.
	•	Small text showing the current date/time (create mode) or entry's creation date (edit mode).
	•	Actions:
	•	Save (primary filled button).
	•	Cancel (text or outlined button, or using back navigation).
Logic:
	•	On mount in "create mode" (/journal/edit):
	    - Initialize local state with empty title/body.
	•	On mount in "edit mode" (/journal/:id/edit):
	    - Load the entry data using the entry ID from route params.
	    - Pre-populate title and body fields with entry data.
	    - Show entry's createdAt date in timestamp display.
	•	On Save (create mode):
	    - Validate that body is not empty.
	    - Call journalStore.createEntry({ title, body }).
	    - The store is responsible for:
	        - Generating id.
	        - Setting createdAt and updatedAt.
	        - Persisting via the repository.
	        - Navigate back to /journal.
	•	On Save (edit mode):
	    - Validate that body is not empty.
	    - Call journalStore.updateEntry(entry) with updated data.
	    - The store is responsible for:
	        - Updating updatedAt timestamp.
	        - Persisting changes via the repository.
	        - Navigate back to /journal.
	•	On Cancel:
	    - Navigate back to /journal without saving changes.
	6.	Edit and Delete Functionality
	•	Edit:
	•	Users can click any entry card to edit it.
	•	Editor opens in edit mode with entry data pre-populated.
	•	Changes are saved using updateEntry action.
	•	Delete:
	•	Each entry card has a delete button (always visible for accessibility).
	•	Clicking delete shows a confirmation dialog (AppDialog component).
	•	Confirming deletion calls journalStore.deleteEntry(id).
	•	Deleted entries are removed from the list and persisted.
	•	Error handling for both edit and delete operations.
	7.	AppDialog Component
	•	Create a reusable dialog component for confirmations and other modal interactions.
	•	Follows Material Design principles.
	•	Supports v-model for visibility control.
	•	Accessible: focus trap, ESC key to close, ARIA attributes.
	•	Used for delete confirmation and can be reused for other confirmations in future stories.
	8.	Local-First Behavior
	•	Ensure that after creating, updating, or deleting an entry:
	    - Returning to /journal shows the changes reflected in the list.
	    - Refreshing the browser tab retains all changes (loaded from IndexedDB).
	    - All operations (create, update, delete) are persisted immediately to IndexedDB.
	•	Optionally integrate the Vite PWA plugin so the application shell is installable and usable offline. Enabling PWA is not strictly required for this epic, but the local persistence must work regardless of network connectivity.
	9.	Tooling & Testing (Minimal)
	•	Ensure the project is configured with:
	    - ESLint (with Vue + TypeScript support).
	    - Prettier for consistent formatting.
	•	Add minimal automated tests:
	    - Unit tests (Vitest) for:
	        - useJournalStore basic behaviors:
	            - Creating an entry sets timestamps and appends to state.
	            - Updating an entry updates the entry and updatedAt timestamp.
	            - Deleting an entry removes it from the store.
            - JournalView:
                - Renders three primary action buttons/cards.
                - Renders correct empty state when there are no entries.
                - Renders entries list when entries exist.
                - Card click navigates to edit route.
                - Delete button shows confirmation dialog.
            - JournalEditorView:
                - Invokes the store's createEntry on save (create mode).
                - Invokes the store's updateEntry on save (edit mode).
                - Loads and pre-populates entry data in edit mode.

⸻

3. Out of Scope (for this Epic)
	•	Emotion tagging (emotion selector, 2×2 emotion grid).
	•	Guided and periodic journaling flows.
	•	Exercises view implementation beyond simple placeholder.
	•	Profile view implementation beyond simple placeholder.
	•	Questionnaires and AI-powered profile/insight features.
	•	Multi-device sync or cloud backup.
	•	Rich text formatting, attachments, or advanced editor features.
	•	Bulk operations (bulk delete, bulk edit).
	•	Swipe-to-delete gestures.
	•	Undo delete functionality.

⸻

4. Success Criteria

The epic is considered complete when:
	1.	The app starts into a Material Design–inspired shell with top app bar and bottom navigation.
	2.	Navigation between /today, /journal, /emotions, /exercises, and /profile works.
	3.	The Journal view shows:
	•	Three primary actions (Free form, Guided, Periodic), with only Free form active.
	•	Either an empty state or a populated list of journal entries, depending on current data.
	4.	The Freeform editor allows the user to:
	•	Enter a title (optional) and body.
	•	Save an entry (create mode), which appears in the Journal list.
	•	Edit an existing entry (edit mode) by clicking on it in the list.
	•	Update an entry, which updates the entry in the list.
	•	Cancel and return without saving changes.
	5.	Edit and Delete functionality:
	•	Users can click any entry card to edit it.
	•	Users can delete entries using the delete button on each card.
	•	Delete requires confirmation via dialog.
	•	All changes (create, update, delete) are persisted to IndexedDB.
	6.	Journal entries:
	•	Are stored in IndexedDB (or equivalent local storage).
	•	Are reloaded on page refresh.
	7.	Linting and tests run successfully (no failing unit tests, lint errors, or TypeScript errors).
