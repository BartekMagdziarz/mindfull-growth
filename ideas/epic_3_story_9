Story 9 â€“ Journal View Chat Indicators

Goal

Update the JournalView and JournalEditorView components to display chat indicators for journal entries that have associated chat sessions. This story enables users to see which entries have chat conversations and provides access to view or continue those conversations. The implementation includes visual indicators, chat history display, and navigation to chat sessions.

â¸»

Scope

	1.	JournalView Chat Indicators
	â€¢	Update JournalView.vue to display chat indicators for entries with chat sessions:
	â€¢	Visual indicators:
	â€¢	For entries that have one or more chat sessions, display a badge or icon indicating chat availability.
	â€¢	Badge design options:
	â€¢	Option A: Small badge with chat icon and count (e.g., "ðŸ’¬ 2" or "Chat (2)").
	â€¢	Option B: Chat icon with a count badge overlay (e.g., chat icon with "2" in a small circle).
	â€¢	Option C: Text indicator (e.g., "2 chats" in secondary text).
	â€¢	Recommendation: Use Option A or B for better visibility (badge with icon and count).
	â€¢	Badge styling:
	â€¢	Use consistent styling with app design (Material Design principles).
	â€¢	Use secondary color or accent color for the badge.
	â€¢	Position: Display the badge near the entry title or in the entry card header.
	â€¢	Badge should be subtle but noticeable.
	â€¢	Badge content:
	â€¢	Show the number of chat sessions for the entry (e.g., "1 chat", "2 chats").
	â€¢	If entry has no chat sessions, don't display any indicator (keep UI clean).
	â€¢	Accessibility:
	â€¢	Add appropriate ARIA labels (e.g., "Entry has 2 chat sessions").
	â€¢	Ensure badge is keyboard accessible if it's clickable.
	â€¢	Implementation:
	â€¢	Access entry's chatSessions array: `entry.chatSessions?.length || 0`.
	â€¢	Use computed property or reactive check to determine if badge should be shown.
	â€¢	Conditionally render the badge based on chat session count.
	â€¢	Use existing UI components (e.g., AppBadge if available, or create a simple badge component).

	2.	JournalView Chat History Access
	â€¢	Add ability to view or access chat history from the journal list:
	â€¢	Clickable badge or button:
	â€¢	Make the chat indicator badge clickable (or add a separate "View chats" button).
	â€¢	When clicked, show chat history or navigate to chat view.
	â€¢	Implementation options:
	â€¢	Option A: Navigate to chat view for the most recent chat session.
	â€¢	Option B: Show a modal/dialog with list of all chat sessions for the entry.
	â€¢	Option C: Navigate to a chat history view (new route).
	â€¢	Recommendation: Use Option B (modal) for MVP, as it's simpler and allows viewing all chats without navigation.
	â€¢	Chat history modal (if Option B is chosen):
	â€¢	Create a ChatHistoryModal component or use AppDialog.
	â€¢	Display list of chat sessions for the entry:
	â€¢	Show chat intention (e.g., "Reflect", "Help see differently").
	â€¢	Show creation date/time (formatted, e.g., "2 days ago" or "Jan 15, 2024").
	â€¢	Show message count or preview (e.g., "5 messages").
	â€¢	For each chat session, provide actions:
	â€¢	"View" button: Navigate to chat view to see the full conversation.
	â€¢	"Delete" button (optional, can be added later): Delete the chat session.
	â€¢	Modal styling:
	â€¢	Use consistent styling with app (AppDialog, AppButton components).
	â€¢	Follow Material Design principles.
	â€¢	Make modal accessible (keyboard navigation, screen reader support).
	â€¢	Navigation to chat view (if Option A or C is chosen):
	â€¢	Navigate to `/journal/:id/chat` route (from Story 6).
	â€¢	Pass the chat session ID as a query parameter or route param if needed.
	â€¢	Update ChatView to handle loading a specific chat session (may require updates to chat store).

	3.	JournalEditorView Chat Sessions Display
	â€¢	Update JournalEditorView.vue to show existing chat sessions when editing an entry:
	â€¢	Chat sessions section:
	â€¢	Add a new section in the journal editor to display existing chat sessions.
	â€¢	Position: Below the entry content area, above the action buttons, or in a sidebar (depending on layout).
	â€¢	Recommendation: Add as a collapsible section below the entry content.
	â€¢	Section header:
	â€¢	Title: "Chat Sessions" or "Previous Conversations".
	â€¢	Show count: "Chat Sessions (2)" or "2 conversations".
	â€¢	Collapsible: Allow users to expand/collapse the section (use AppAccordion or similar if available).
	â€¢	Chat sessions list:
	â€¢	Display each chat session as a card or list item.
	â€¢	For each session, show:
	â€¢	Chat intention (e.g., "Reflect", "Help see differently", "Custom").
	â€¢	Creation date/time (formatted, e.g., "Created 2 days ago").
	â€¢	Message count (e.g., "5 messages").
	â€¢	Preview of first message or last message (optional, truncated to ~50 characters).
	â€¢	Actions for each session:
	â€¢	"View" button: Navigate to chat view to see the full conversation.
	â€¢	"Continue" button (if applicable): Start a new conversation with the same intention (optional enhancement).
	â€¢	"Delete" button: Delete the chat session (optional, can be added later or in this story).
	â€¢	Empty state:
	â€¢	If entry has no chat sessions, show a message: "No chat sessions yet. Start a conversation using the Chat button."
	â€¢	Or hide the section entirely if no chats exist.
	â€¢	Styling:
	â€¢	Use AppCard components for each chat session item.
	â€¢	Use consistent spacing and typography.
	â€¢	Make the list scrollable if there are many sessions.
	â€¢	Integration with Chat button:
	â€¢	Ensure the Chat button (from Story 5) is still visible and functional.
	â€¢	The Chat button creates new chat sessions, while this section shows existing ones.

	4.	Chat Session Display Components
	â€¢	Create reusable components for displaying chat session information:
	â€¢	ChatSessionCard component (optional, but recommended):
	â€¢	Component: `src/components/ChatSessionCard.vue` (or similar name).
	â€¢	Props:
	â€¢	`chatSession: ChatSession` (the chat session to display).
	â€¢	`showActions?: boolean` (whether to show View/Delete buttons, default: true).
	â€¢	`compact?: boolean` (compact view for lists, default: false).
	â€¢	Displays:
	â€¢	Chat intention (with icon or color coding if desired).
	â€¢	Creation date/time.
	â€¢	Message count.
	â€¢	Optional preview of conversation.
	â€¢	Actions (View, Delete buttons if showActions is true).
	â€¢	Styling: Use AppCard or similar component for consistent design.
	â€¢	ChatIntentionBadge component (optional):
	â€¢	Component: `src/components/ChatIntentionBadge.vue` (or similar name).
	â€¢	Props:
	â€¢	`intention: ChatIntention` (the chat intention value).
	â€¢	`customPrompt?: string` (optional, for custom intentions).
	â€¢	Displays: Formatted intention label (e.g., "Reflect", "Help see differently").
	â€¢	Styling: Badge or chip styling with appropriate colors.
	â€¢	Rationale: Reusable components make it easier to display chat sessions consistently across views and reduce code duplication.

	5.	Chat Store Integration for Loading Sessions
	â€¢	Update chat store (from Story 3) to support loading existing chat sessions:
	â€¢	Add method to load chat sessions for an entry:
	â€¢	`loadChatSessionsForEntry(entryId: string): Promise<ChatSession[]>`.
	â€¢	This method should:
	â€¢	Get the journal entry from journal store.
	â€¢	Return the entry's chatSessions array (or empty array if none).
	â€¢	Handle errors gracefully (entry not found, etc.).
	â€¢	Add method to load a specific chat session:
	â€¢	`loadChatSession(entryId: string, chatSessionId: string): Promise<ChatSession | null>`.
	â€¢	This method should:
	â€¢	Get the journal entry from journal store.
	â€¢	Find the chat session by ID in the entry's chatSessions array.
	â€¢	Return the chat session or null if not found.
	â€¢	Set the chat session as the current session (for viewing in ChatView).
	â€¢	Add method to delete a chat session (optional, can be added in this story):
	â€¢	`deleteChatSession(entryId: string, chatSessionId: string): Promise<void>`.
	â€¢	This method should:
	â€¢	Get the journal entry from journal store.
	â€¢	Remove the chat session from the entry's chatSessions array.
	â€¢	Update the entry in the database.
	â€¢	Handle errors gracefully.
	â€¢	State management:
	â€¢	Ensure chat store methods are reactive and update UI when chat sessions are loaded or deleted.
	â€¢	Provide computed properties or getters for easy access to chat sessions.

	6.	Chat Session Deletion (Optional but Recommended)
	â€¢	Implement chat session deletion functionality:
	â€¢	Delete button:
	â€¢	Add "Delete" button to each chat session card/item.
	â€¢	Use destructive styling (e.g., error color or outlined variant).
	â€¢	Position: In the actions area of the chat session card.
	â€¢	Confirmation dialog:
	â€¢	Show confirmation dialog when user clicks Delete.
	â€¢	Dialog content:
	â€¢	Title: "Delete chat session?"
	â€¢	Message: "Are you sure you want to delete this conversation? This action cannot be undone."
	â€¢	Actions:
	â€¢	"Cancel" button: Closes dialog, no action.
	â€¢	"Delete" button: Confirms deletion, calls chat store's deleteChatSession method.
	â€¢	Use AppDialog component for consistency.
	â€¢	Deletion functionality:
	â€¢	Call `chatStore.deleteChatSession(entryId, chatSessionId)`.
	â€¢	On success:
	â€¢	Remove the chat session from the UI (reactive update).
	â€¢	Show success feedback (e.g., snackbar: "Chat session deleted").
	â€¢	On error:
	â€¢	Show error message (e.g., "Failed to delete chat session. Please try again.").
	â€¢	Error handling:
	â€¢	Handle cases where entry or chat session doesn't exist.
	â€¢	Handle database errors gracefully.
	â€¢	Allow retry on failure.

	7.	Date/Time Formatting Utilities
	â€¢	Create or use date/time formatting utilities for chat sessions:
	â€¢	Format chat session creation dates:
	â€¢	Relative time for recent sessions (e.g., "Just now", "2 hours ago", "3 days ago").
	â€¢	Absolute date for older sessions (e.g., "Jan 15, 2024" or "15/01/2024").
	â€¢	Format message timestamps (if displaying in chat session preview):
	â€¢	Use the same formatting as in ChatView (from Story 7).
	â€¢	Implementation:
	â€¢	Use existing date formatting utility if available (e.g., from `src/utils/dateFormat.ts`).
	â€¢	Or create a new utility function: `formatChatSessionDate(timestamp: string): string`.
	â€¢	Consider timezone handling (use user's local timezone).

	8.	Component Tests
	â€¢	Add comprehensive component tests (Vitest with Vue Test Utils) for:
	â€¢	JournalView Chat Indicators:
	â€¢	Test that chat indicator badge is displayed for entries with chat sessions.
	â€¢	Test that badge shows correct count (e.g., "2 chats" for entry with 2 sessions).
	â€¢	Test that badge is not displayed for entries without chat sessions.
	â€¢	Test that badge is clickable (if implemented).
	â€¢	Test that clicking badge opens chat history modal or navigates to chat view.
	â€¢	Test that badge has proper ARIA labels.
	â€¢	Chat History Modal (if implemented):
	â€¢	Test that modal displays list of chat sessions correctly.
	â€¢	Test that each session shows correct information (intention, date, message count).
	â€¢	Test that "View" button navigates to chat view with correct session.
	â€¢	Test that "Delete" button shows confirmation dialog.
	â€¢	Test that deletion works correctly.
	â€¢	Test that modal is accessible (keyboard navigation, screen reader).
	â€¢	JournalEditorView Chat Sessions:
	â€¢	Test that chat sessions section is displayed when entry has chat sessions.
	â€¢	Test that section is hidden or shows empty state when entry has no chat sessions.
	â€¢	Test that each chat session is displayed correctly.
	â€¢	Test that "View" button navigates to chat view.
	â€¢	Test that section is collapsible (if implemented).
	â€¢	Chat Session Components:
	â€¢	Test that ChatSessionCard displays chat session information correctly.
	â€¢	Test that ChatIntentionBadge displays intention label correctly.
	â€¢	Test that components handle missing or invalid data gracefully.
	â€¢	Chat Store Integration:
	â€¢	Test that loadChatSessionsForEntry returns correct chat sessions.
	â€¢	Test that loadChatSession loads and sets current session correctly.
	â€¢	Test that deleteChatSession removes session from entry.
	â€¢	Test error handling (entry not found, session not found).
	â€¢	Edge Cases:
	â€¢	Test with entries that have many chat sessions (10+).
	â€¢	Test with entries that have no chat sessions.
	â€¢	Test with deleted entries (should handle gracefully).
	â€¢	Test with invalid chat session data.
	â€¢	Use mocking for:
	â€¢	Journal store (mock `getEntryById`, `updateEntry`).
	â€¢	Chat store (mock `loadChatSessionsForEntry`, `loadChatSession`, `deleteChatSession`).
	â€¢	Router (mock `router.push`, `router.back`).
	â€¢	Follow existing test patterns in `src/views/__tests__/`.
	â€¢	Use descriptive test names that explain what is being tested.

	9.	Integration Tests
	â€¢	Add integration tests for chat indicators and history access:
	â€¢	Full Flow Integration Test:
	â€¢	Create a journal entry.
	â€¢	Create a chat session for the entry (via chat view, from Story 7 and 8).
	â€¢	Save the chat session.
	â€¢	Navigate to journal list.
	â€¢	Verify that entry shows chat indicator badge with count "1".
	â€¢	Click the badge (or "View chats" button).
	â€¢	Verify that chat history modal opens (or navigates to chat view).
	â€¢	Verify that chat session is listed in the modal.
	â€¢	Click "View" on the chat session.
	â€¢	Verify that chat view loads with the correct conversation.
	â€¢	Journal Editor Integration Test:
	â€¢	Create a journal entry.
	â€¢	Create and save multiple chat sessions for the entry.
	â€¢	Navigate to journal editor for the entry.
	â€¢	Verify that chat sessions section is displayed.
	â€¢	Verify that all chat sessions are listed.
	â€¢	Click "View" on a chat session.
	â€¢	Verify that chat view loads with the correct conversation.
	â€¢	Delete Flow Integration Test:
	â€¢	Create a journal entry with a chat session.
	â€¢	Navigate to journal editor.
	â€¢	Click "Delete" on a chat session.
	â€¢	Confirm deletion in dialog.
	â€¢	Verify that chat session is removed from the list.
	â€¢	Verify that entry's chatSessions array is updated in database.
	â€¢	Verify that chat indicator badge count is updated (if viewing journal list).
	â€¢	Use test utilities from `src/__tests__/integration/testUtils.ts` if available.
	â€¢	Follow existing integration test patterns.

â¸»

Acceptance Criteria

	â€¢	JournalView Chat Indicators:
	â€¢	Entries with chat sessions display a chat indicator badge.
	â€¢	Badge shows the correct count of chat sessions (e.g., "1 chat", "2 chats").
	â€¢	Badge is not displayed for entries without chat sessions.
	â€¢	Badge is properly styled and positioned.
	â€¢	Badge has appropriate ARIA labels for accessibility.
	â€¢	Chat History Access:
	â€¢	Clicking chat indicator (or "View chats" button) opens chat history modal or navigates to chat view.
	â€¢	Chat history modal displays all chat sessions for the entry (if modal is implemented).
	â€¢	Each chat session in modal shows correct information (intention, date, message count).
	â€¢	"View" button in modal navigates to chat view with correct session.
	â€¢	Modal is accessible (keyboard navigation, screen reader support).
	â€¢	JournalEditorView Chat Sessions:
	â€¢	Chat sessions section is displayed when entry has chat sessions.
	â€¢	Section shows correct count of chat sessions.
	â€¢	Each chat session is displayed with correct information (intention, date, message count).
	â€¢	"View" button navigates to chat view with correct session.
	â€¢	Section is hidden or shows empty state when entry has no chat sessions.
	â€¢	Section is collapsible (if implemented).
	â€¢	Chat Session Components:
	â€¢	ChatSessionCard component displays chat session information correctly (if created).
	â€¢	ChatIntentionBadge component displays intention label correctly (if created).
	â€¢	Components handle missing or invalid data gracefully.
	â€¢	Chat Store Integration:
	â€¢	`loadChatSessionsForEntry` method returns correct chat sessions for an entry.
	â€¢	`loadChatSession` method loads and sets current session correctly.
	â€¢	`deleteChatSession` method removes session from entry (if implemented).
	â€¢	Methods handle errors gracefully (entry not found, session not found).
	â€¢	Chat Session Deletion (if implemented):
	â€¢	Delete button is present on each chat session card.
	â€¢	Clicking Delete shows confirmation dialog.
	â€¢	Confirming deletion removes the chat session from the entry.
	â€¢	Success feedback is shown after successful deletion.
	â€¢	Error messages are shown if deletion fails.
	â€¢	Date/Time Formatting:
	â€¢	Chat session dates are formatted correctly (relative time for recent, absolute for older).
	â€¢	Formatting is consistent across all views.
	â€¢	The app can be started and:
	â€¢	Journal list shows chat indicators for entries with chat sessions.
	â€¢	Users can click chat indicators to view chat history.
	â€¢	Journal editor shows existing chat sessions when editing an entry.
	â€¢	Users can view existing chat sessions from the editor.
	â€¢	Users can delete chat sessions (if implemented).
	â€¢	Chat indicators update correctly when chat sessions are added or deleted.
	â€¢	Component tests for chat indicators pass.
	â€¢	Integration tests for chat history access pass.
	â€¢	Linting and TypeScript checks pass with no new errors.

â¸»

Out of Scope

	â€¢	Editing saved chat sessions (out of scope for this epic).
	â€¢	Exporting chat sessions (out of scope for this epic).
	â€¢	Searching or filtering chat sessions (out of scope for this epic).
	â€¢	Chat session analytics or insights (out of scope for this epic).
	â€¢	Bulk deletion of chat sessions (single deletion is sufficient for MVP).
	â€¢	Chat session sharing or copying (out of scope for this epic).
	â€¢	Advanced chat session preview (showing full conversation in modal, simple preview is sufficient).
	â€¢	Chat session archiving (deletion is sufficient for MVP).
	â€¢	Chat session sorting or grouping (chronological order is sufficient for MVP).
	â€¢	Chat session tags or labels (out of scope for this epic).

â¸»

Technical Considerations

	â€¢	Chat Indicator Performance:
	â€¢	For entries with many chat sessions, ensure badge rendering is performant.
	â€¢	Consider using computed properties to calculate chat session counts efficiently.
	â€¢	Avoid recalculating counts on every render (use memoization if needed).
	â€¢	Modal vs. Navigation Decision:
	â€¢	Modal approach (Option B) is recommended for MVP as it's simpler and keeps users in context.
	â€¢	Navigation approach (Option A or C) provides a dedicated view but requires more routing logic.
	â€¢	Consider user experience: Modal is faster for quick viewing, navigation is better for detailed viewing.
	â€¢	For MVP, modal is sufficient. Navigation can be added later if needed.
	â€¢	Chat Session Loading:
	â€¢	When loading chat sessions, ensure they're loaded efficiently (don't load all entries' chats at once).
	â€¢	Load chat sessions only when needed (lazy loading).
	â€¢	Consider caching chat sessions in the store to avoid repeated database queries.
	â€¢	Deletion Confirmation UX:
	â€¢	Make the confirmation dialog clear and non-intrusive.
	â€¢	Use destructive action styling for "Delete" button (e.g., error color or outlined variant).
	â€¢	Ensure dialog is accessible (keyboard navigation, screen reader support).
	â€¢	Consider adding a "Don't ask again" option for users who frequently delete chats (optional enhancement).
	â€¢	Date/Time Formatting:
	â€¢	Use consistent date formatting across the app.
	â€¢	Consider user's locale and timezone preferences (if available).
	â€¢	For MVP, using browser's default locale is acceptable.
	â€¢	Component Reusability:
	â€¢	Creating reusable components (ChatSessionCard, ChatIntentionBadge) is recommended but optional.
	â€¢	If components are created, ensure they're flexible and can be used in different contexts.
	â€¢	If not creating separate components, ensure chat session display logic is consistent across views.
	â€¢	State Management:
	â€¢	Ensure chat sessions are reactive and update UI when sessions are added or deleted.
	â€¢	Use Pinia store for centralized state management.
	â€¢	Consider using computed properties for derived state (e.g., chat session count).
	â€¢	Accessibility:
	â€¢	Ensure all new UI elements are accessible (keyboard navigation, screen reader support).
	â€¢	Add appropriate ARIA labels to badges, buttons, and modals.
	â€¢	Ensure focus management in modals (focus trap, return focus on close).
	â€¢	Testing Strategy:
	â€¢	Mock journal store and chat store thoroughly in component tests.
	â€¢	Test both success and error scenarios.
	â€¢	Test edge cases (no chats, many chats, deleted entries).
	â€¢	Use integration tests to verify full flows with real stores (or mocked stores that behave like real ones).

â¸»

Implementation Notes

	â€¢	JournalView Chat Indicator Implementation:
	â€¢	```vue
	â€¢	<!-- In JournalView.vue entry card -->
	â€¢	<div v-if="entry.chatSessions?.length" class="flex items-center gap-2">
	â€¢	  <AppBadge :count="entry.chatSessions.length" variant="secondary">
	â€¢	    <ChatIcon class="w-4 h-4" />
	â€¢	    <span>{{ entry.chatSessions.length }} chat{{ entry.chatSessions.length > 1 ? 's' : '' }}</span>
	â€¢	  </AppBadge>
	â€¢	</div>
	â€¢	```
	â€¢	Or using a simple badge:
	â€¢	```vue
	â€¢	<div
	â€¢	  v-if="entry.chatSessions?.length"
	â€¢	  class="inline-flex items-center gap-1 px-2 py-1 rounded-full bg-secondary/20 text-secondary text-sm"
	â€¢	  @click="handleViewChats(entry.id)"
	â€¢	  role="button"
	â€¢	  tabindex="0"
	â€¢	  aria-label="View {{ entry.chatSessions.length }} chat session(s)"
	â€¢	>
	â€¢	  <ChatIcon class="w-4 h-4" />
	â€¢	  <span>{{ entry.chatSessions.length }}</span>
	â€¢	</div>
	â€¢	```
	â€¢	Chat History Modal Implementation:
	â€¢	```vue
	â€¢	<AppDialog
	â€¢	  v-model="showChatHistoryModal"
	â€¢	  title="Chat History"
	â€¢	  :max-width="600"
	â€¢	>
	â€¢	  <div v-if="chatSessions.length === 0" class="text-center py-8 text-on-surface-variant">
	â€¢	    No chat sessions yet.
	â€¢	  </div>
	â€¢	  <div v-else class="space-y-2">
	â€¢	    <ChatSessionCard
	â€¢	      v-for="session in chatSessions"
	â€¢	      :key="session.id"
	â€¢	      :chat-session="session"
	â€¢	      @view="handleViewChat(session)"
	â€¢	      @delete="handleDeleteChat(session)"
	â€¢	    />
	â€¢	  </div>
	â€¢	</AppDialog>
	â€¢	```
	â€¢	JournalEditorView Chat Sessions Section:
	â€¢	```vue
	â€¢	<!-- In JournalEditorView.vue, below entry content -->
	â€¢	<AppAccordion v-if="entry.chatSessions?.length" title="Chat Sessions">
	â€¢	  <div class="space-y-3">
	â€¢	    <ChatSessionCard
	â€¢	      v-for="session in entry.chatSessions"
	â€¢	      :key="session.id"
	â€¢	      :chat-session="session"
	â€¢	      @view="handleViewChat(session)"
	â€¢	      @delete="handleDeleteChat(session)"
	â€¢	    />
	â€¢	  </div>
	â€¢	</AppAccordion>
	â€¢	<div v-else class="text-center py-4 text-on-surface-variant text-sm">
	â€¢	  No chat sessions yet. Start a conversation using the Chat button.
	â€¢	</div>
	â€¢	```
	â€¢	Chat Store Methods (extend existing store from Story 3):
	â€¢	```typescript
	â€¢	async loadChatSessionsForEntry(entryId: string): Promise<ChatSession[]> {
	â€¢	  const entry = await journalStore.getEntryById(entryId)
	â€¢	  if (!entry) {
	â€¢	    throw new Error('Journal entry not found')
	â€¢	  }
	â€¢	  return entry.chatSessions || []
	â€¢	}
	â€¢	
	â€¢	async loadChatSession(entryId: string, chatSessionId: string): Promise<ChatSession | null> {
	â€¢	  const entry = await journalStore.getEntryById(entryId)
	â€¢	  if (!entry) {
	â€¢	    throw new Error('Journal entry not found')
	â€¢	  }
	â€¢	  
	â€¢	  const session = entry.chatSessions?.find(cs => cs.id === chatSessionId)
	â€¢	  if (!session) {
	â€¢	    return null
	â€¢	  }
	â€¢	  
	â€¢	  // Set as current session for viewing
	â€¢	  this.currentChatSession = session
	â€¢	  return session
	â€¢	}
	â€¢	
	â€¢	async deleteChatSession(entryId: string, chatSessionId: string): Promise<void> {
	â€¢	  const entry = await journalStore.getEntryById(entryId)
	â€¢	  if (!entry) {
	â€¢	    throw new Error('Journal entry not found')
	â€¢	  }
	â€¢	  
	â€¢	  const chatSessions = entry.chatSessions || []
	â€¢	  const updatedSessions = chatSessions.filter(cs => cs.id !== chatSessionId)
	â€¢	  
	â€¢	  await journalStore.updateEntry({
	â€¢	    ...entry,
	â€¢	    chatSessions: updatedSessions
	â€¢	  })
	â€¢	}
	â€¢	```
	â€¢	ChatSessionCard Component (if created):
	â€¢	```vue
	â€¢	<template>
	â€¢	  <AppCard class="p-4">
	â€¢	    <div class="flex items-start justify-between">
	â€¢	      <div class="flex-1">
	â€¢	        <div class="flex items-center gap-2 mb-2">
	â€¢	          <ChatIntentionBadge :intention="chatSession.intention" />
	â€¢	          <span class="text-sm text-on-surface-variant">
	â€¢	            {{ formatChatSessionDate(chatSession.createdAt) }}
	â€¢	          </span>
	â€¢	        </div>
	â€¢	        <p class="text-sm text-on-surface-variant">
	â€¢	          {{ chatSession.messages.length }} message{{ chatSession.messages.length > 1 ? 's' : '' }}
	â€¢	        </p>
	â€¢	      </div>
	â€¢	      <div v-if="showActions" class="flex gap-2">
	â€¢	        <AppButton variant="text" size="small" @click="$emit('view')">
	â€¢	          View
	â€¢	        </AppButton>
	â€¢	        <AppButton variant="text" size="small" @click="$emit('delete')" destructive>
	â€¢	          Delete
	â€¢	        </AppButton>
	â€¢	      </div>
	â€¢	    </div>
	â€¢	  </AppCard>
	â€¢	</template>
	â€¢	
	â€¢	<script setup lang="ts">
	â€¢	import type { ChatSession } from '@/domain/chatSession'
	â€¢	
	â€¢	defineProps<{
	â€¢	  chatSession: ChatSession
	â€¢	  showActions?: boolean
	â€¢	}>()
	â€¢	
	â€¢	defineEmits<{
	â€¢	  view: []
	â€¢	  delete: []
	â€¢	}>()
	â€¢	</script>
	â€¢	```
	â€¢	Date Formatting Utility:
	â€¢	```typescript
	â€¢	export function formatChatSessionDate(timestamp: string): string {
	â€¢	  const date = new Date(timestamp)
	â€¢	  const now = new Date()
	â€¢	  const diffMs = now.getTime() - date.getTime()
	â€¢	  const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24))
	â€¢	  
	â€¢	  if (diffDays === 0) {
	â€¢	    const diffHours = Math.floor(diffMs / (1000 * 60 * 60))
	â€¢	    if (diffHours === 0) {
	â€¢	      const diffMins = Math.floor(diffMs / (1000 * 60))
	â€¢	      return diffMins < 1 ? 'Just now' : `${diffMins} minute${diffMins > 1 ? 's' : ''} ago`
	â€¢	    }
	â€¢	    return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`
	â€¢	  }
	â€¢	  
	â€¢	  if (diffDays < 7) {
	â€¢	    return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`
	â€¢	  }
	â€¢	  
	â€¢	  return date.toLocaleDateString()
	â€¢	}
	â€¢	```
	â€¢	File Organization:
	â€¢	Updates to existing files:
	â€¢	`src/views/JournalView.vue` â€“ add chat indicators and history access.
	â€¢	`src/views/JournalEditorView.vue` â€“ add chat sessions section.
	â€¢	`src/stores/chat.store.ts` â€“ add loadChatSessionsForEntry, loadChatSession, deleteChatSession methods.
	â€¢	New files (optional):
	â€¢	`src/components/ChatSessionCard.vue` â€“ reusable chat session card component.
	â€¢	`src/components/ChatIntentionBadge.vue` â€“ reusable intention badge component.
	â€¢	`src/utils/dateFormat.ts` â€“ date formatting utilities (if not already exists, or extend existing).
	â€¢	Test files:
	â€¢	`src/views/__tests__/JournalView.spec.ts` â€“ extend existing test file with chat indicator tests.
	â€¢	`src/views/__tests__/JournalEditorView.spec.ts` â€“ extend existing test file with chat sessions tests.
	â€¢	`src/components/__tests__/ChatSessionCard.spec.ts` â€“ component tests (if component is created).
	â€¢	`src/__tests__/integration/chat-indicators-flow.spec.ts` â€“ integration tests.
	â€¢	Dependencies:
	â€¢	Import chat store from Story 3.
	â€¢	Import journal store (assume it exists).
	â€¢	Import router and route from vue-router.
	â€¢	Import UI components (AppButton, AppCard, AppDialog, AppBadge, AppAccordion if available).
	â€¢	Testing:
	â€¢	Extend existing test files for JournalView and JournalEditorView.
	â€¢	Add new test suites for chat indicators and chat sessions display.
	â€¢	Mock chat store and journal store thoroughly.
	â€¢	Test user interactions (clicking badges, buttons, modals).
	â€¢	Test reactive updates when chat sessions are added or deleted.
	â€¢	Follow existing test patterns and naming conventions.
	â€¢	Create integration tests for full chat indicator flows.

